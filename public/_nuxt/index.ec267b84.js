import{f as R,s as c,B as C,o as m,c as f,a as l,t as E,h as u,n as A,q as I,g as M,b as g,j as k,w as V,F as B,k as z,v as N,C as P,E as T,m as q,l as $}from"./entry.88697106.js";import O from"./uploadLayout.f856bb08.js";import"./TopNav.8710f2e4.js";import"./nuxt-link.4a68c461.js";const H={class:"w-[100%] relative flex justify-center"},X={__name:"uploadError",props:["errorType"],setup(h){const y=h,{errorType:d}=R(y);let a=c("");return C(()=>d.value,()=>{d.value=="caption"?a.value="Maximum 150 characters.":d.value=="bio"?a.value="Maximum 80 characters.":d.value=="file"?a.value="Unsupported file. Use MP4 instead.":a.value=""}),(x,v)=>(m(),f("div",H,[l("div",{class:A(["absolute top-6 z-50 mx-auto bg-black bg-opacity-70 text-white px-14 py-3 rounded-sm",u(d)?"visible":"invisible"])},E(u(a)),3)]))}},G=X;const J={key:0,class:"fixed flex items-center justify-center top-0 left-0 w-full h-screen bg-black z-50 bg-opacity-50"},K={class:"w-full mt-[80px] mb-[40px] bg-white dark:bg-black shadow-lg rounded-md py-6 md:px-10 px-4"},Q={key:0,class:"text-[23px] font-semibold"},W={key:1,class:"text-[23px] font-semibold"},Y=l("div",{class:"text-gray-400 mt-1"},"Add tiles to your story",-1),Z={class:"mt-5"},ee={class:"flex items-center justify-between"},te=l("div",{class:"mb-1 text-[15px]"},"Title",-1),le={class:"text-gray-400 text-[12px]"},se={class:"list"},oe=["onDrop"],ae=l("div",{class:"px-2 py-1.5 mt-8 text-white text-[15px] w-[80%] bg-[#f0cc2c] rounded-sm"}," Select file ",-1),ne={class:"flex gap-3"},re=l("button",{class:"add-btn"},"+",-1),me={__name:"index",setup(h){const{$userStore:y}=$(),d=I();let a=c(null),x=c(null),v=c(null),r=c(""),p=c(null),b=c(null),_=c(!1),F="All",w=new URL(document.location).searchParams.get("repostId");C(()=>r.value,e=>{if(e.length>=150){v.value="caption";return}v.value=null}),M(async()=>{const e=document.querySelector(".add-btn");document.querySelector(".list");function t(s){const o=s.target.parentElement;console.log(s,"target"),o.remove()}document.querySelectorAll(".list  .list-item").forEach(function(s){s.onclick=t}),e.onclick=function(s){console.log(s);const o=document.createElement("div"),n=document.createElement("textarea"),i=document.createElement("button");o.classList.add("list-item"),o.innerHTML="List Item"+s.screenX,o.appendChild(i),o.appendChild(n),o.style.position="relative",n.style.border="2px solid ",n.style.position="relative",n.style.width="400px solid ",n.style.marginTop="40px",n.style.height="400px solid ",n.setAttribute("class","slideTextArea"),n.style.justifySelf="center",i.style.height="100px solid ",i.style.border="2px solid ",i.style.width="100px solid ",i.style.float="right",i.style.fontSize="2rem",i.style.marginRight="10px",i.innerHTML="x",i.onclick=t,e.parentNode.lastChild.insertAdjacentElement("beforebegin",o)}});const L=()=>{x.value=URL.createObjectURL(a.value.files[0]),p.value=a.value.files[0]},S=e=>{v.value="",a.value=e.dataTransfer.files[0],p.value=e.dataTransfer.files[0],a.value.name.substring(a.value.name.lastIndexOf(".")+1),x.value=URL.createObjectURL(e.dataTransfer.files[0])},U=()=>{a.value=null,x.value=null,p.value=null,r.value=""},j=e=>{let t="";for(let s=0;s<e.length;s++)t+=","+e[s].value;return t+=","+w,t},D=async()=>{b.value=null;let e=new FormData,t=document.getElementsByClassName("slideTextArea"),s=j(t);e.append("video",p.value||""),e.append("text",r.value||""),e.append("tags",F),e.append("textValueForSlide",s),console.log(p.value,"upload data"),p.value&&r.value&&(_.value=!0);try{(await y.createPost(e)).status===200&&setTimeout(()=>{d.push("/profile/"+y.id),_.value=!1},1e3)}catch(o){b.value=o.response.data,console.log(b.value),_.value=!1}};return(e,t)=>{const s=G,o=q;return m(),f(B,null,[g(s,{errorType:u(v)},null,8,["errorType"]),u(_)?(m(),f("div",J,[g(o,{class:"animate-spin ml-1",name:"mingcute:loading-line",size:"100",color:"#FFFFFF"})])):k("",!0),g(O,null,{default:V(()=>[l("div",K,[l("div",null,[u(w)?(m(),f("div",Q,"Repost")):(m(),f("div",W,"Make a story")),Y]),l("div",Z,[l("div",ee,[te,l("div",le,E(u(r).length)+"/80",1)]),z(l("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>P(r)?r.value=n:r=n),maxlength:"80",type:"text",class:"w-full border p-2.5 rounded-md focus:outline-none"},null,512),[[N,u(r)]])]),l("ul",se,[u(x)?k("",!0):(m(),f("label",{key:0,for:"fileInput",onDrop:T(S,["prevent"]),onDragover:t[1]||(t[1]=T(()=>{},["prevent"])),class:"md:mx-0 mx-auto mt-4 mb-6 flex flex-col items-center justify-center w-full max-w-[260px] h-[470px] text-center p-3 border-2 border-dashed border-gray-300 rounded-lg hover:bg-gray-100 cursor-pointer"},[g(o,{name:"majesticons:cloud-upload",size:"40",color:"#b3b3b1"}),ae,l("input",{ref_key:"file",ref:a,type:"file",id:"fileInput",onInput:L,hidden:""},null,544)],40,oe)),l("div",ne,[l("button",{onClick:t[2]||(t[2]=n=>U()),class:"px-10 py-2.5 mt-8 border text-[16px] hover:bg-gray-100 rounded-sm"}," Discard "),l("button",{onClick:t[3]||(t[3]=n=>D()),class:"px-10 py-2.5 mt-8 border text-[16px] text-white bg-[#f0cc2c] rounded-sm"}," Post ")]),re])])]),_:1})],64)}}};export{me as default};
